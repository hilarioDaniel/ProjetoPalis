vnames <- list( 
  c("row1", "row2", "row3"), # row names 
  c("col1")) # column names 

# Bp(0) -------------------------------------------------------------------

Bp_0 <- c(2141.87, 2176.33, 10.40)

m0 <- matrix(Bp_0, nrow = 3, ncol = 1, byrow = TRUE, dimnames = vnames)

somaQuad_0 <- m0[1,1]^2 + m0[2,1]^2 + m0[3,1]^2

# Bp(1) -------------------------------------------------------------------

Bp_1 <- c(2161.80, 2162.30, 10.23)

m1 <- matrix(Bp_1, nrow = 3, ncol = 1, byrow = TRUE, dimnames = vnames)

somaQuad_1 <- m1[1,1]^2 + m1[2,1]^2 + m1[3,1]^2

# Bp(2) -------------------------------------------------------------------

Bp_2 <- c(2175.30, 2183.00, 11.27)

m2 <- matrix(Bp_2, nrow = 3, ncol = 1, byrow = TRUE, dimnames = vnames)

somaQuad_2 <- m2[1,1]^2 + m2[2,1]^2 + m2[3,1]^2

# Bp(3) -------------------------------------------------------------------

Bp_3 <- c(2154.50, 11.40, 11.60)

m3 <- matrix(Bp_3, nrow = 3, ncol = 1, byrow = TRUE, dimnames = vnames)

somaQuad_3 <- m3[1,1]^2 + m3[2,1]^2 + m3[3,1]^2

# Bp(4) -------------------------------------------------------------------

Bp_4 <- c(2141.10, 2174.17, 10.60)

m4 <- matrix(Bp_4, nrow = 3, ncol = 1, byrow = TRUE, dimnames = vnames)

somaQuad_4 <- m4[1,1]^2 + m4[2,1]^2 + m4[3,1]^2

# Bp(5) -------------------------------------------------------------------

Bp_5 <- c(2162.97, 2162.20, 10.60)

m5 <- matrix(Bp_5, nrow = 3, ncol = 1, byrow = TRUE, dimnames = vnames)

somaQuad_5 <- m5[1,1]^2 + m5[2,1]^2 + m5[3,1]^2



# vetor Y -----------------------------------------------------------------

Y <- c(somaQuad_0, somaQuad_1, somaQuad_2, somaQuad_3, somaQuad_4, somaQuad_5)


# matriz X ----------------------------------------------------------------

dados <- c(m0[1,1], m0[2,1], m0[3,1],1,
           m1[1,1], m1[2,1], m1[3,1],1,
           m2[1,1], m2[2,1], m2[3,1],1,
           m3[1,1], m3[2,1], m3[3,1],1,
           m4[1,1], m4[2,1], m4[3,1],1,
           m5[1,1], m5[2,1], m5[3,1],1)

X <- matrix(dados, nrow = 6, ncol = 4, byrow = TRUE)


# vetor Beta --------------------------------------------------------------

Beta_l1 <- t(X)%*% X

Beta_l2 <- solve (Beta_l1)

Beta_l3 <- t(X)%*% Y

Beta <- Beta_l2 %*% Beta_l3


# vetor V -----------------------------------------------------------------

(V = 0.5 * Beta)

# geomagnetic field strength B --------------------------------------------


